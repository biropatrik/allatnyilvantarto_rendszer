<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>Állatok</title>
    </h:head>
    <h:body>
        <link type="text/css" rel="stylesheet" href="../resources/css/animal.css?v=${applicationInfoBean.projectVersion}" />
        <link type="text/css" rel="stylesheet" href="../resources/css/navigationBar.css" />
        <div class="content">
            <f:metadata>
                <f:viewAction action="#{loginController.checkLogin('animalList.xhtml',3)}" />
            </f:metadata>

            <div class="navigation">
                <h:form id="navigation">
                <h:commandLink  value="Üzenetek" action="#{navigationController.index}"></h:commandLink>
                <h:commandLink  value="Új üzenet" action="#{navigationController.newMail}"></h:commandLink>
                <h:commandLink  value="Saját állatok" class="active" action="#{navigationController.animalList}"></h:commandLink>
                <h:commandLink  value="Állatkereső" action="#{navigationController.animalSearch}"></h:commandLink>
                <h:commandLink  class="logout" action="#{loginController.logout}" value="Kilépés"></h:commandLink>
                <h:commandLink  style="float: right" value="Fiók" action="#{navigationController.account}"></h:commandLink>
                </h:form>
            </div>
        
        <h:form id="checkAnimal">
            <div class="content-block">
            <table>
                <tbody class="hover">
                    <tr>
                        <th>Azonosító szám</th>
                        <th>Név</th>
                        <th>Faj</th>
                        <th>Születési dátum</th>
                    </tr>
                    <c:forEach items="#{animalController.allAnimal}" var="animal">
                        <tr class="animal_#{animal.earTag}" style="background-color:#B5B5B5;">
                            <td>#{animal.earTag}</td>
                            <td>#{animal.name}</td>
                            <td>#{animalController.getSpeciesName(animal.speciesId)}</td>
                            <td>#{animalController.getDateFormat(animal.birthdate)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none">
                            <th colspan="4" style="border: solid thin;">Az egyed adatai</th>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Egyed azonosítója:</td>
                            <td colspan="3">#{animal.earTag}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Születési dátum:</td>
                            <td colspan="3">#{animalController.getDateFormat(animal.birthdate)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Neme:</td>
                            <td colspan="3">#{animalController.getSexName(animal.sex)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Egyed faj (kód):</td>
                            <td colspan="3">(#{animal.speciesId}) #{animalController.getSpeciesName(animal.speciesId)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Egyed fajta (kód):</td>
                            <td colspan="3">(#{animal.breedId}) #{animalController.getBreedName(animal.breedId)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Egyed színe (kód):</td>
                            <td colspan="3">(#{animal.colorId}) #{animalController.getColorName(animal.colorId)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Tenyészetkód:</td>
                            <td colspan="3">#{animalController.getBreedingIdByAnimal(animal.earTag)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Tartó neve:</td>
                            <td colspan="3">#{animalController.userName}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Tenyészet címe:</td>
                            <td colspan="3">#{animalController.getBreedAddressByAnimal(animal.earTag)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Tenyészetbe érkezés dátuma:</td>
                            <td colspan="3">#{animalController.getBreedingHasAnimalStartDate(animal.earTag)}</td>
                        </tr>
                        
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <th colspan="4" style="border: solid thin;">Az ellés adatai</th>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Anya(recipiens) azonosítója:</td>
                            <td colspan="3">#{animal.motherId}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Ikerellés:</td>
                            <td colspan="3">#{animalController.getTwinningName(animal.twinning)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Ellés módja (kód):</td>
                            <td colspan="3">(#{animal.calvingId}) #{animalController.getCalvingName(animal.calvingId)}</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <td>Borjú tömege:</td>
                            <td colspan="3">#{animal.calvingWeight} kg</td>
                        </tr>
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <th colspan="4" style="border: solid thin;">Az egyed előző tenyészetei</th>
                        </tr>
                        <c:if test="#{animalController.getAllBreedingsHasAnimalByEarTag(animal.earTag).size() > 0}">
                            <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                                <th>Tenyészetkód</th>
                                <th>Bekerülés</th>
                                <th>Kikerülés</th>
                            </tr> 
                        </c:if>
                        <c:forEach items="#{animalController.getAllBreedingsHasAnimalByEarTag(animal.earTag)}" var="breeding">
                            <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                                <td>#{breeding.breedingId}</td>
                                <td>#{animalController.getDateFormat(breeding.startDate)}</td>
                                <td>#{animalController.getDateFormat(breeding.endDate)}</td>
                            </tr>
                        </c:forEach>
                        
                        <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                            <th colspan="4" style="border: solid thin;">Az egyed betegségei</th>
                        </tr>
                        <c:if test="#{animalController.getAllAnimalHasDiseasesByEarTags(animal.earTag).size() > 0}">
                            <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                                <th>Betegség neve</th>
                                <th>Betegség kezdete</th>
                                <th>Betegség vége</th>
                                <th>Megjegyzés</th>
                            </tr> 
                        </c:if>
                        <c:forEach items="#{animalController.getAllAnimalHasDiseasesByEarTags(animal.earTag)}" var="diseases">
                            <tr id="details_#{animal.earTag}" class="#{animal.earTag}" style="display: none;">
                                <td>#{animalController.getAnimalDiseasesName(diseases.animalDiseasesId)}</td>
                                <td>#{animalController.getDateFormat(diseases.startDate)}</td>
                                <td>#{animalController.getDateFormat(diseases.endDate)}</td>
                                <td>#{diseases.comment}</td>
                            </tr>
                        </c:forEach>
                    </c:forEach>
                </tbody>
            </table>
            </div>
            </h:form>
            </div>
        
        <script src="jquery-3.5.1.js"></script>
        <ui:repeat value="#{animalController.allAnimal}" var="animal">
            <script>
                $('body').on('click', '.animal_#{animal.earTag}', function(){
                    $('.#{animal.earTag}').toggle();
                });
            </script>
        </ui:repeat>
    </h:body>
</html>

